<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filter.Today: 감정분석 대시보드</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<header id="navigation-bar">

    <div class="logo">🎨 Filter.Today</div>

    <div class="month-selector">
        <label for="year-select">select:</label>
        <select id="year-select"></select>
        <select id="month-select"></select>
    </div>

    <div class="auth-buttons">

        <span sec:authorize="isAuthenticated()" style="font-weight: bold; color: #333; margin-left: 10px;">
             <span sec:authentication="name">User</span>님
        </span>

        <button id="login-btn"
                onclick="location.href='/login'"
                sec:authorize="isAnonymous()">
            로그인
        </button>

        <button id="logout-btn"
                onclick="location.href='/logout'"
                sec:authorize="isAuthenticated()">
            로그아웃
        </button>
    </div>
</header>

<main class="dashboard-container">
    <section id="hue-map-section">
        <h2>🌈 Tone & Mood </h2>

        <div class="emotion-legend">
            <div class="legend-item">
                <span class="color-dot" style="background-color: #FFD700;"></span> 기쁨
            </div>
            <div class="legend-item">
                <span class="color-dot" style="background-color: #ADD8E6;"></span> 차분함
            </div>
            <div class="legend-item">
                <span class="color-dot" style="background-color: #E0E0E0;"></span> 보통
            </div>
            <div class="legend-item">
                <span class="color-dot" style="background-color: #4682B4;"></span> 슬픔
            </div>
            <div class="legend-item">
                <span class="color-dot" style="background-color: #808080;"></span> 불안
            </div>
            <div class="legend-item">
                <span class="color-dot" style="background-color: #FF4500;"></span> 분노
            </div>
        </div>
        <div id="calendar-grid">
            <div class="day-header">월</div>
            <div class="day-header">화</div>
            <div class="day-header">수</div>
            <div class="day-header">목</div>
            <div class="day-header">금</div>
            <div class="day-header">토</div>
            <div class="day-header">일</div>
        </div>
    </section>

    <aside class="sidebar">
        <section id="stats-section">
            <h3>📊 STATISTICS</h3>
            <div class="chart-container">
                <canvas id="emotion-pie-chart"></canvas>
            </div>
        </section>

        <section id="diary-input-section">
            <h3>📝 DIARY </h3>

            <div id="date-display-area" style="margin: 20px 0 5px 0; font-weight: bold; color: #555;">
                📅 날짜를 선택해주세요
            </div>
            <input type="hidden" id="selected-date-hidden">

            <div id="color-picker-placeholder" style="margin-top: 10px;">
                <input type="color" id="emotion-color-picker" value="#ff9900">
                <span id="selected-emotion-label"> [EmotionColor]</span>
                <textarea id="diary-text-input" placeholder="오늘의 감정을 기록하거나, 과거의 기록을 클릭하여 수정하세요." rows="4"></textarea>
                <button id="save-diary-btn">저장</button>
                <button id="delete-diary-btn" style="display:none;">삭제</button>
            </div>
        </section>
    </aside>
</main>

<script th:src="@{/js/auth/auth.js}" defer></script>
<script th:src="@{/js/chart.js}" defer></script>
<script th:src="@{/js/diary.js}" defer></script>
<script th:src="@{/js/dashboard.js}" defer></script>
</body>
</html>